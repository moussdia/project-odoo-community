<?xml version="1.0"?>
<odoo>

    <!--
        View form inherit
     -->
    <record id="crm_lead_view_form_inherit" model="ir.ui.view">
        <field name="name">crm.lead.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">

            <xpath expr="/form/header/button[@name='action_set_won_rainbowman']" position="after">
                <button name="%(sale_crm_extension.action_standby_raison_wizard)d" string="METTRE EN STAND-BY"
                        type="action" class="btn-warning" attrs="{'invisible':['|', ('step','in',
                    ['suspect','prospect','analyse','negociation','order_ongoing']), ('is_standby', '=', True)]}"/>

                <button name="action_restore" string="RESTAURER"
                        type="object" class="btn-warning" attrs="{'invisible':['|',('is_standby', '=', False), ('step','in',
                    ['suspect','prospect','analyse','negociation','order_ongoing'])]}"/>
            </xpath>

            <xpath expr="//button[@name='action_view_sale_quotation']" position="attributes">
                <attribute name="attrs">{'invisible':[('step','in',
                    ['suspect','prospect','analyse'])]}
                </attribute>
            </xpath>

            <xpath expr="//button[@name='action_set_automated_probability']" position="replace">
            </xpath>

            <xpath expr="//field[@name='probability']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='automated_probability']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='is_automated_probability']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="/form/sheet/div[2]/h2/div[4]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="/form/sheet/div[2]/h2/div[3]" position="after">
                <!-- Add your fields or attributes here -->
                <div class="col" readonly="1" style="margin-left:10px">
                    <span class="oe_edit_only o_pls_probability">
                        <label for="probability_percent"/>
                    </span>
                    <div id="probability" class="o_row d-flex">
                        <field name="probability_percent" widget="float" class="oe_inline"/>
                        <span class="oe_grey">%</span>
                    </div>
                </div>
            </xpath>

            <xpath expr="//field[@name='recurring_plan']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='recurring_revenue']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="/form/sheet/div[2]/h2/div[3]" position="replace">

            </xpath>

            <!--<small class="oe_grey" position="replace"></small>-->

            <xpath expr="/form/sheet/div[2]/h2/div[2]" position="after">
                <!-- Add your fields or attributes here -->
                <div class="col" readonly="1">
                    <span class="oe_edit_only o_pls_probability">
                        <label for="probability_of_being_chosen"/>
                    </span>
                    <div id="probability" class="o_row d-flex">
                        <field name="probability_of_being_chosen" widget="float" class="oe_inline"/>
                        <span class="oe_grey">%</span>
                    </div>
                </div>
            </xpath>

            <xpath expr="/form/sheet/div[2]/label[1][@class='oe_edit_only']" position="replace">
                <field name="company_type" options="{'horizontal': true}" class="oe_edit_only" widget="radio"
                       groups="base.group_no_one"/>
                <div class="oe_edit_only">
                    <label for="name" string="Opportunité"/>
                </div>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[3]/group/group[3]/field[@name='source_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[3]/group/group[3]/field[@name='campaign_id']" position="attributes">
                <attribute name="options">{'no_create_edit': True}</attribute>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[3]/group/group[3]/field[@name='medium_id']" position="attributes">
                <attribute name="string">Mode d'entrée en relation</attribute>
                <attribute name="options">{'no_create_edit': True}</attribute>
            </xpath>

            <xpath expr="//field[@name='user_id']" position="attributes">
                <attribute name="string">Commercial</attribute>
            </xpath>

            <xpath expr="//field[@name='user_id']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='team_id']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>

            <xpath expr="//field[@name='team_id']" position="after">
                <field name="year_id"
                       attrs="{'required':[('step','in',['prospect','analyse','negociation', 'closing', 'order_ongoing'])]}"
                       options="{'no_create': True, 'no_create_edit':True}"/>
                <field name="period_id"
                       attrs="{'required':[('step','in',
                       ['prospect','analyse','negociation', 'closing', 'order_ongoing'])]}"
                       domain="[('year_id', '=', year_id), ('state', '=', 'open')]"
                       options="{'no_create': True, 'no_create_edit':True}"/>
            </xpath>

            <xpath expr="//field[@name='email_from']" position="attributes">
                <attribute name="required">1</attribute>
                <attribute name="class">o_required_modifier_cst</attribute>
            </xpath>
            <xpath expr="//field[@name='phone']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>

            <xpath expr="/form/sheet/group/group[2]/field[@name='partner_id']" position="attributes">
                <attribute name="invisible">0</attribute>
                <attribute name="attrs">{'invisible':[('is_customer','=', 'no')],'required':[('is_customer','=',
                    'yes')]}
                </attribute>
            </xpath>

            <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>

            <xpath expr="//field[@name='tag_ids']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//button[@name='action_sale_quotations_new']" position="attributes">
                <attribute name="attrs">{'invisible':[('step','in',
                    ['suspect','prospect','analyse','closing','order_ongoing'])]}
                </attribute>
            </xpath>

            <xpath expr="//button[@name='action_set_won_rainbowman']" position="attributes">
                <attribute name="attrs">{'invisible':['|',('step','in',
                    ['suspect','prospect','analyse','negociation','order_ongoing']), ('is_standby', '=', True)]}
                </attribute>
            </xpath>
            <xpath expr="//button[@name='%(crm.crm_lead_lost_action)d']" position="attributes">
                <attribute name="attrs">{'invisible':['|',('step','in',
                    ['suspect','prospect','analyse','negociation','order_ongoing']), ('is_standby', '=', True)]}
                </attribute>
            </xpath>

            <xpath expr="/form/sheet/div[@name='button_box']" position="attributes">
                <attribute name="attrs">{'invisible':[('step','=', 'suspect')]}</attribute>
            </xpath>

            <xpath expr="/form/sheet/div[2]/h2" position="attributes">
                <attribute name="attrs">{'invisible':[('step','=', 'suspect')]}</attribute>
            </xpath>

            <xpath expr="//form/sheet/group/group[2]" position="attributes">
                <attribute name='string'>Informations de la société</attribute>
            </xpath>

            <xpath expr="/form/sheet/group/group[2]/field[@name='partner_id']" position="before">
                <field name="is_customer" widget="radio" options="{'horizontal':True}"/>
            </xpath>

            <xpath expr="/form/sheet/group/group[2]/field[@name='partner_id']" position="after">
                <field name="partner_name"
                       attrs="{'invisible': [('is_customer','=','yes')], 'required': [('is_customer','!=','yes')]}"/>
                <field name="litigation"
                       attrs="{'invisible':[('step','=', 'suspect')],'required':[('step','!=', 'suspect')]}"
                       widget="radio" options="{'horizontal':True}"/>
                <field name="reason_for_the_dispute"
                       attrs="{'invisible': [('litigation','=', 'no')],'required':[('litigation','!=', 'no')]}"/>

                <field name="reference" invisible="1"/>
                <field name="step" invisible="1"/>
                <field name="is_company" invisible="1"/>
                <label for="street" string="Adresse" class="o_required_modifier_cst"/>
                <div class="o_address_format">
                    <field name="street" placeholder="Rue..." class="o_address_street" required="1"/>
                    <field name="street2" placeholder="Rue 2..." class="o_address_street"/>
                    <field name="city" placeholder="Ville" class="o_address_city" required="1"/>
                    <!--<field name="state_id" class="o_address_state" placeholder="Etat" options='{"no_open": True}'/>-->
                    <field name="zip" placeholder="Code postal" class="o_address_zip"/>
                    <field name="country_id" placeholder="Pays" class="o_address_country"
                           options='{"no_open": True, "no_create": True}' required="1"/>
                </div>
                <field name="website" widget="url" placeholder="e.g. https://www.odoo.com"/>
                <field name="lang_id"/>
                <field name="geolocalisation"/>
            </xpath>
            <xpath expr="/form/sheet/group/group[4]" position="attributes">
                <attribute name='string'>Informations de contact</attribute>
            </xpath>
            <xpath expr="//field[@name='date_deadline']" position="after">
                <label for="contact_name" class="o_required_modifier_cst"/>
                <div class="o_row">
                    <field name="contact_name" required="1"/>
                    <field name="title" placeholder="Titre" domain="[]" options='{"no_open": True}'/>
                </div>
                <field name="function"/>
                <field name="partner_email" required="1"/>
                <field name="partner_phone" widget="phone" required="1"/>
                <field name="mobile" widget="phone" options="{'enable_sms': True}" required="1"/>
                <label for="manager_name" class="o_required_modifier_cst"/>
                <div class="o_row">
                    <field name="manager_name"/>
                    <!--<field name="title" placeholder="Titre" domain="[]" options='{"no_open": True}'/>-->
                </div>
                <field name="manager_function"/>
            </xpath>
            <xpath expr="//field[@name='date_deadline']" position="replace">
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="date_deadline" attrs="{'invisible':[('step','=', 'suspect')]}"/>
                <field name="is_standby" readonly="1" attrs="{'invisible':[('step','in',
                    ['suspect','prospect','analyse','negociation','order_ongoing'])]}"/>
                <label for="work_advancement" attrs="{'invisible':[('step','in',
                    ['suspect','prospect','analyse','negociation','closing'])]}"/>
                <div class="o_row">
                    <field name="work_advancement" attrs="{'invisible':[('step','in',
                    ['suspect','prospect','analyse','negociation','closing'])]}"/>
                    <field name="percentage" readonly="1" attrs="{'invisible':[('step','in',
                    ['suspect','prospect','analyse','negociation','closing'])]}"/>
                </div>
                <field name="customer_category" attrs="{'invisible':[('step','=','suspect')],'required':[('step','in',
                    ['prospect','analyse','negociation','closing','order_ongoing'])]}"/>
                <field name="potential_customer" attrs="{'invisible':[('step','=','suspect')],'required':[('step','in',
                    ['prospect','analyse','negociation','closing','order_ongoing'])]}"/>
                <field name="source_id" required="1" string="Origine du deal"/>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[3]/group/group[1]" position="replace">
            </xpath>
            <xpath expr="//form/sheet/notebook/page[3]/group/group[1]" position="replace">
            </xpath>
            <xpath expr="//form/sheet/group" position="after">
                <group string="Autres informations de la société" col="4" colspan="4"
                       attrs="{'invisible':[('step','=', 'suspect')]}">
                    <group style="width: 50%;">
                        <label for="capital"/>
                        <div class="o_row">
                            <field name="capital" required="1"/>
                            <field name="monetary"/>
                        </div>
                        <field name="legal_form_id" options="{'no_create_edit':True}"/>
                        <!--attrs="{'required':[('step','!=', 'suspect')]}"-->
                        <field name="rccm"/>
                        <field name="taxpayer_account"/>
                        <field name="tax_declaration"/>
                        <field name="cnps"/>
                    </group>
                    <group style="width: 50%;">
                        <field name="group_id" options="{'no_create_edit':True}"/>
                        <field name="branch_activity1" options="{'no_create_edit':True}"/>
                        <field name="primary_activity" options="{'no_create_edit':True}"/>
                        <field name="company_siz_id" options="{'no_create_edit':True}"/>
                        <label for="number_employees"/>
                        <div class="o_row">
                            <field name="number_employees" readonly="1"/>
                            <field name="number_man" style="text-align:right"/>
                            <span class="oe_inline">Hommes</span>
                            <field name="number_woman" style="text-align:right"/>
                            <span class="oe_inline">Femmes</span>
                        </div>
                        <label for="company_turnover"/>
                        <div class="o_row">
                            <field name="company_turnover"/>
                            <field name="monetary"/>
                        </div>
                        <label for="budget"/>
                        <div class="o_row">
                            <field name="budget"/>
                            <field name="monetary"/>
                        </div>
                        <field name="deal" widget="radio" options="{'horizontal': true}"/>
                    </group>
                </group>
            </xpath>
            <xpath expr="/form/sheet/div[2]/label[1][@class='oe_edit_only']" position="replace">
                <div class="oe_edit_only">
                    <label for="name" string="Objet" invisible="1"/>
                </div>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[3]/group" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[3]/group" position="after">
                <group>
                    <group string="Marketing">
                        <field name="survey_campaign_id" readonly="1"/>
                        <field name="survey_study_id" readonly="1"/>
                    </group>
                    <group></group>
                </group>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[3]" position="after">
                <page string="Fiche client" invisible="1">
                    <group invisible="1">
                        <group>
                            <field name="job" options="{'no_create_edit':True}"/>
                            <field name="market" options="{'no_create_edit':True}"/>
                        </group>
                        <group>
                            <field name="development_strategy"/>
                            <field name="organization" widget="many2many_tags" options="{'no_create_edit':True}"/>
                        </group>
                    </group>

                    <group>
                        <group string="Informations de la société">
                            <field name="partner_name"/>
                            <label for="street" string="Address"/>
                            <div class="o_address_format">
                                <field name="street" placeholder="Street..." class="o_address_street"/>
                                <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                <field name="city" placeholder="City" class="o_address_city"/>
                                <!--<field name="state_id" class="o_address_state" placeholder="State"
                                       options="{&quot;no_open&quot;: True}"/>-->
                                <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                <field name="country_id" placeholder="Country" class="o_address_country"
                                       options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                            </div>
                            <field name="website" widget="url" placeholder="e.g. https://www.odoo.com"/>
                            <field name="lang_id"/>
                        </group>
                        <group string="Informations de contact">
                            <label for="contact_name"/>
                            <div class="o_row">
                                <field name="contact_name"/>
                                <field name="title" placeholder="Title" domain="[]"
                                       options="{&quot;no_open&quot;: True}"/>
                            </div>
                            <field name="function"/>
                            <field name="mobile" widget="phone" options="{'enable_sms': True}"/>
                        </group>


                    </group>

                </page>
            </xpath>
            <xpath expr="//form/sheet/notebook/page[4]" position="after">
                <page string="Historique du compte" attrs="{'invisible':[('step','=', 'suspect')]}">
                    <field name="account_history"
                           placeholder="Date de naissance de l’entreprise, d’où elle vient et ou elle va..."/>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[5]" position="after">
                <page string="Organe de décision" attrs="{'invisible':[('step','=', 'suspect')]}">
                    <group>
                        <field name="decision_making_body" nolabel="1">
                            <tree editable="bottom">
                                <field name="name" string="Nom"/>
                                <field name="function" string="Fonction"/>
                                <field name="phone" string="Contact"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[6]" position="after">
                <page string="Opportunités" invisible="1">
                    <group>
                        <group>
                            <field name="opportunity" required="0"/>
                            <field name="income" invisible="1"/>
                        </group>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[7]" position="after">
                <page string="Attraits" invisible="1">
                    <group>
                        <field name="attrait" nolabel="1" placeholder="Description"/>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[8]" position="after">
                <page string="Atouts" invisible="1">
                    <group>
                        <field name="advantage" nolabel="1" placeholder="Description"/>
                    </group>
                </page>
            </xpath>
            <xpath expr="//form/sheet/notebook/page[9]" position="after">
                <page string="Diagnostic" attrs="{'invisible':[('step','=', 'suspect')]}">
                    <group>
                        <group invisible="1">
                            <field name="position"/>
                            <field name="analyse_emoff"/>
                        </group>
                    </group>

                    <group>
                        <group>
                            <field name="opportunity" required="0"/>
                            <field name="threat" required="0"/>
                        </group>
                        <group>
                            <field name="strength" required="0"/>
                            <field name="weakness" required="0"/>
                        </group>
                    </group>

                    <group>
                        <group>
                            <div class="col">
                                <!--<h2>
                                    <label for="order_ids" class="oe_edit_only"/>
                                </h2>-->
                                <div class="o_row">
                                    <field name="order_history_ids" readonly="1">
                                        <tree>
                                            <field name="name" string="Réf"/>
                                            <field name="amount_untaxed"/>
                                            <field name="comments"/>
                                        </tree>
                                    </field>
                                </div>
                            </div>
                        </group>
                        <group>
                            <field name="sale_amount_total" string="C.A réalisé"/>
                            <field name="expense_total_exploitation" force_save="1" invisible="1"/>
                            <field name="margin" readonly="1" force_save="1"/>
                            <label for="notice"/>
                            <div class="o_row">
                                <field name="notice" style="width: 100%;"/>
                            </div>
                        </group>
                    </group>

                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[10]" position="after">
                <page string="Circuit de décision" attrs="{'invisible':[('step','in', ['suspect','prospect'])]}">
                    <group>
                        <group>
                            <field name="grid"/>
                            <field name="grid_opinion" widget="radio" options="{'horizontal': true}"/>
                        </group>
                        <group>
                            <field name="decision_organization"/>
                        </group>
                    </group>
                    <group>
                        <field name="allies_ids">
                            <tree editable="bottom">
                                <field name="name" string="Nom"/>
                                <field name="function" string="Fonction"/>
                                <field name="contact" string="Contact"/>
                            </tree>
                        </field>
                    </group>
                    <group>
                        <field name="opponent_ids">
                            <tree editable="bottom">
                                <field name="name" string="Nom"/>
                                <field name="function" string="Fonction"/>
                                <field name="contact" string="Contact"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[11]" position="after">
                <page string="Plan de maillage" attrs="{'invisible':[('step','in', ['suspect','prospect'])]}">
                    <group>
                        <div class="col">
                            <h2>
                                <label for="lead_manager_ids" class="oe_edit_only"/>
                            </h2>
                            <div class="o_row">
                                <field name="lead_manager_ids">
                                    <tree editable="bottom">
                                        <field name="type_of_maillage"/>
                                        <field name="partner" string="P.dirigeante"/>
                                        <field name="power_of_decision"/>
                                        <field name="visit_frequency" string="Fq visite"/>
                                        <field name="visit_frequency_period" string="tps"/>
                                        <field name="need_to_have_lunch"/> <!--  widget="radio" options="{'horizontal': true}" -->
                                        <field name="business_lunch_frequency"
                                               attrs="{'invisible': [('need_to_have_lunch', '!=','yes')],'required': [('need_to_have_lunch', '=','yes')]}"/>
                                        <field name="business_lunch_frequency_period" string="tps"
                                               attrs="{'invisible': [('need_to_have_lunch', '!=','yes')],'required': [('need_to_have_lunch', '=','yes')]}"/>
                                        <field name="business_lunch_budget"
                                               attrs="{'invisible': [('need_to_have_lunch', '!=','yes')],'required': [('need_to_have_lunch', '=','yes')]}"/>
                                        <field name="sponsor_name"/>
                                    </tree>
                                </field>
                            </div>
                        </div>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[12]" position="after">
                <page string="Mon équipe interne" attrs="{'invisible':[('step','=', 'suspect')]}">
                    <group>
                        <group>
                            <field name="sponsor"/>
                        </group>
                    </group>
                    <group>
                        <field name="internal_team" nolabel="1">
                            <tree editable="bottom">
                                <field name="name" string="Nom"/>
                                <field name="function" string="Fonction"/>
                                <field name="phone" string="Contact"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[12]" position="after">
                <page string="Equipe chez le client" attrs="{'invisible':[('step','in', ['suspect','prospect'])]}">
                    <group>
                        <field name="customer_team_ids" nolabel="1">
                            <tree editable="bottom">
                                <field name="name" string="Nom"/>
                                <field name="function" string="Fonction"/>
                                <field name="contact" string="Contact"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>


            <xpath expr="//form/sheet/notebook/page[13]" position="after">
                <page string="Budget" invisible="1">
                    <group>
                        <group>
                            <label for="budget"/>
                            <div class="o_row">
                                <field name="budget"/>
                                <field name="monetary"/>
                            </div>
                        </group>
                    </group>
                </page>
            </xpath>

            <xpath expr="//notebook" position="inside">
                <page string="Plan d'action" attrs="{'invisible':[('step','in', ['suspect','prospect'])]}">
                    <group>
                        <field name="activity_history_ids" nolabel="1" readonly="1">
                            <tree>
                                <field name="activity_type_id" string="Type d'activité"/>
                                <field name="summary" string="Résumé"/>
                                <field name="date_deadline" string="Date d'échéance"/>
                                <field name="user_id" string="Assigné à"/>
                                <field name="note" string="Notes"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Géolocalisation" name="geo_location" attrs="{'invisible':[('step','=', 'suspect')]}">
                    <group colspan="2" col="2">
                        <separator string="Géolocalisation" colspan="2"/>
                        <button
                                string="Géolocaliser"
                                name="open_google_maps"
                                colspan="2"
                                icon="fa-check"
                                type="object"/>
                        <div>
                            <span class="oe_inline">( On</span>
                            <field name="date_localization" nolabel="1" class="oe_inline"/>
                            <span>: Alt :</span>
                            <field name="lead_altitude" nolabel="1" class="oe_inline"/>
                            <span>; Lat :</span>
                            <field name="lead_latitude" nolabel="1" class="oe_inline"/>
                            <span>; Long:</span>
                            <field name="lead_longitude" nolabel="1" class="oe_inline"/>
                            <span>)</span>
                        </div>
                    </group>
                    <group invisible="1">
                        <field name="google_map_location" widget="googlemap" nolabel="1"/>
                    </group>
                </page>
                <page string="Charges d'exploitation" attrs="{'invisible':[('step','in', ['suspect','prospect'])]}">
                    <group>
                        <field name="expense_ids" nolabel="1" force_save="1"
                               groups="sale_crm_extension.group_chef_service_administration_vente">
                            <tree editable="bottom">
                                <field name="name" force_save="1"/>
                                <field name="amount" force_save="1"/>
                            </tree>
                        </field>
                    </group>
                    <group name="note_group" col="6">
                        <group class="oe_subtotal_footer oe_right" colspan="2" style="border-top: 0;">
                            <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                <label for="expense_total_exploitation"/>
                            </div>
                            <field name="expense_total_exploitation" nolabel="1" class="oe_subtotal_footer_separator"
                                   widget="monetary" options="{'currency_field': 'currency_id'}"/>
                        </group>
                        <div class="oe_clear"/>
                    </group>
                </page>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[1]" position="replace">
            </xpath>

            <xpath expr="//notebook" position="inside">
                <page string="Notes internes" attrs="{'invisible':[('step','=','suspect')]}">
                    <field name="description" placeholder="Ajouter une description..."/>
                </page>
            </xpath>

            <xpath expr="/form/sheet/notebook/page[2]" position="attributes">
                <attribute name="attrs">{'invisible':[('step','=','suspect')]}</attribute>
            </xpath>

        </field>
    </record>

    <!--
       View tree inherit
    -->
    <record id="view_lead_tree_inherit" model="ir.ui.view">
        <field name="name">view.lead.tree.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='expected_revenue']" position="after">
                <field name="amount_untaxed" sum="Montant" optional="show"/>
                <field name="estimated_order_date"/>
            </xpath>

        </field>
    </record>

    <!--print_report method is called from server action-->
    <record id="action_consolidated_plan_tour_report" model="ir.actions.server">
        <field name="name">Crm Report</field>
        <field name="type">ir.actions.server</field>
        <field name="model_id" ref="model_crm_lead"/>
        <field name="state">code</field>
        <field name="code">
            action = model.print_consolidated_tour_plan_report()
        </field>
    </record>

    <!--  Menuitems for report printing  -->
    <menuitem id="sale_crm_reports_menu"
              name="Rapports"
              parent="crm.crm_menu_root"
              sequence="21"/>
    <menuitem id="menu_create_consolidated_tour_plan_report"
              name="Plans de tournée consolidé"
              action="action_consolidated_plan_tour_report"
              parent="sale_crm_reports_menu"
              sequence="110"
              groups="sale_crm_extension.group_chef_service_commercial"/>

</odoo>
