<?xml version="1.0"?>
<odoo>
    <!--View form inherit-->

    <record id="survey_question_view_form_inherit" model="ir.ui.view">
        <field name="name">survey.question</field>
        <field name="model">survey.question</field>
        <field name="inherit_id" ref="survey.survey_question_form"/>
        <field name="arch" type="xml">
            <xpath expr="/form/sheet/div" position="after">
                <group>
                    <group>
                        <field name="template_id" required="1" readonly="0"/>
                    </group>
                    <group></group>
                </group>
            </xpath>
        </field>
    </record>


    <record id="survey_view_form_inherit" model="ir.ui.view">
        <field name="name">survey.survey</field>
        <field name="model">survey.survey</field>
        <field name="inherit_id" ref="survey.survey_form"/>
        <field name="arch" type="xml">

            <xpath expr="/form/sheet/notebook/page[1]/field/tree/field[@name='title']" position="before">
                <field name="template_id" invisible="1"/>
            </xpath>

            <xpath expr="/form/sheet/div[2]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="/form/sheet/div[2]" position="before">
                <div class="oe_title" style="width: 100%;">
                    <label for="title" string="Titre de l'étude" class="oe_edit_only"/>
                    <h1>
                        <field name="title" placeholder="e.g. Satisfaction Survey"/>
                    </h1>
                </div>
            </xpath>
            <xpath expr="/form/sheet/div[2]" position="after">
                <group>
                    <group>
                        <field name="strategy_id" required="1"/>
                        <field name="client_segment" required="1"/>
                        <field name="editor" required="1"/>
                    </group>
                    <group>
                        <field name="start_date" required="1"/>
                        <field name="and_date" required="1"/>
                        <field name="template_id" required="1"
                               options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                </group>
                <group string="Informations"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b')],'required':[('client_segment', '=', 'b2b')]}">
                    <group>
                        <field name="branch_activity_id"/>
                        <field name="company_size_id"/>
                        <label for="number_employees"/>
                        <div class="o_row">
                            <field name="number_employees" readonly="1"/>
                            <field name="number_man" style="text-align:right"/>
                            <span class="oe_inline">Hommes</span>
                            <field name="number_woman" style="text-align:right"/>
                            <span class="oe_inline">Femmes</span>
                        </div>
                        <label for="company_turnover"/>
                        <div class="o_row">
                            <field name="company_turnover"/>
                            <field name="monetary"/>
                        </div>
                        <label for="capital"/>
                        <div class="o_row">
                            <field name="capital" required="1"/>
                            <field name="monetary"/>
                        </div>
                        <field name="volume_consumed"/>
                        <label for="internationalized_degree"/>
                        <div class="o_row">
                            <field name="internationalized_degree"/>
                            <span class="oe_inline">%</span>
                        </div>
                        <field name="activity_type"/>
                    </group>
                    <group>
                        <field name="centralisation_type"/>
                        <field name="sector"/>

                        <field name="searched_advantage"/>
                        <field name="weight_function"/>
                        <field name="price_importance"/>
                    </group>
                </group>
                <group string="Géographique"
                       attrs="{'invisible':[('client_segment', '!=', 'b2c')]}">
                    <group>
                        <field name="region_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="country_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="town_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="commune_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                    <group>
                        <field name="need"/>
                        <field name="reference"/>
                        <field name="center_of_interest_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                    </group>
                </group>
                <group string="Socio démographique"
                       attrs="{'invisible':[('client_segment', '!=', 'b2c')]}">
                    <group>
                        <field name="age_id" widget="many2many_tags" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="sex" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="gender"/>
                        <field name="number_of_person" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="religion_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="culture_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                    </group>
                    <group>
                        <field name="nationality" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="income" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="csp_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="familial_status"/>
                        <field name="education_level_id" attrs="{'required':[('client_segment', '=', 'b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                </group>
                <group string="Psychologiques"
                       attrs="{'invisible':[('client_segment', '!=', 'b2c')]}">
                    <group>
                        <field name="life_style" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="value_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="conviction"/>
                    </group>
                    <group>
                        <field name="center_of_interest2_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="personality_id" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                </group>
                <group string="Comportement"
                       attrs="{'invisible':[('client_segment', '!=', 'b2c')]}">
                    <group>
                        <field name="purchase_frequency_id" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="consumption_habit"/>
                    </group>
                    <group>
                        <field name="level_of_live" attrs="{'required':[('client_segment', '=', 'b2c')]}"/>
                        <field name="use"/>
                    </group>
                </group>

                <group string="Informations"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b-b2c')],'required':[('client_segment', '=', 'b2b-b2c')]}">
                    <group>
                        <field name="branch_activity_id"/>
                        <field name="company_size_id"/>
                        <label for="number_employees"/>
                        <div class="o_row">
                            <field name="number_employees" readonly="1"/>
                            <field name="number_man" style="text-align:right"/>
                            <span class="oe_inline">Hommes</span>
                            <field name="number_woman" style="text-align:right"/>
                            <span class="oe_inline">Femmes</span>
                        </div>
                        <label for="company_turnover"/>
                        <div class="o_row">
                            <field name="company_turnover"/>
                            <field name="monetary"/>
                        </div>
                        <label for="capital"/>
                        <div class="o_row">
                            <field name="capital" required="1"/>
                            <field name="monetary"/>
                        </div>
                        <field name="volume_consumed"/>
                        <label for="internationalized_degree"/>
                        <div class="o_row">
                            <field name="internationalized_degree"/>
                            <span class="oe_inline">%</span>
                        </div>
                        <field name="activity_type"/>
                    </group>
                    <group>
                        <field name="centralisation_type"/>
                        <field name="sector"/>

                        <field name="searched_advantage"/>
                        <field name="weight_function"/>
                        <field name="price_importance"/>
                    </group>
                </group>
                <group string="Géographique"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b-b2c')]}">
                    <group>
                        <field name="region_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="country_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="town_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="commune_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                    <group>
                        <field name="need"/>
                        <field name="reference"/>
                        <field name="center_of_interest_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                    </group>
                </group>
                <group string="Socio démographique"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b-b2c')]}">
                    <group>
                        <field name="age_id" widget="many2many_tags" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="sex" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="gender"/>
                        <field name="number_of_person" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="religion_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="culture_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                    </group>
                    <group>
                        <field name="nationality" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="income" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="csp_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="familial_status" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="education_level_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                </group>
                <group string="Psychologiques"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b-b2c')]}">
                    <group>
                        <field name="life_style" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="value_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="conviction"/>
                    </group>
                    <group>
                        <field name="center_of_interest2_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="personality_id" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                    </group>
                </group>
                <group string="Comportement"
                       attrs="{'invisible':[('client_segment', '!=', 'b2b-b2c')]}">
                    <group>
                        <field name="purchase_frequency_id" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="consumption_habit"/>
                    </group>
                    <group>
                        <field name="level_of_live" attrs="{'required':[('client_segment', '=', 'b2b-b2c')]}"/>
                        <field name="use"/>
                    </group>
                </group>
            </xpath>
            <xpath expr="/form/sheet/notebook/page[3]" position="after">
                <page string="Suspect" attrs="{'invisible':[('state', 'in', ('draft','open'))]}">
                    <group>
                        <button name="%(sale_crm_extension.action_create_lead_wizard)d"
                                context="{'default_survey_study_id': active_id}"
                                string="Fournir les suspects aux commerciaux"
                                type="action" class="oe_highlight"
                                attrs="{'invisible':[('state', '!=', 'closed')]}"
                                groups="sale_crm_extension.group_chef_service_commercial"/>
                    </group>
                    <group>
                        <field name="study_suspect_ids" nolabel="1">
                            <tree>
                                <field name="name"/>
                                <field name="contact"/>
                                <field name="email"/>
                                <field name="address"/>
                                <field name="city"/>
                                <field name="function"/>
                                <field name="attribute" invisible="1"/>
                            </tree>
                        </field>
                    </group>
                </page>
                <page string="Recommandation"
                      attrs="{'invisible':[('state', 'in', ('draft','open','analyse'))]}">
                    <group>
                        <group>
                            <field name="segmentation"
                                   attrs="{'required':[('state', 'in', ('recommandation','closed'))]}"/>
                            <field name="target" attrs="{'required':[('state', 'in', ('recommandation','closed'))]}"/>
                        </group>
                        <group>
                            <field name="positioning"
                                   attrs="{'required':[('state', 'in', ('recommandation','closed'))]}"/>
                            <field name="mix_marketing"
                                   attrs="{'required':[('state', 'in', ('recommandation','closed'))]}"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>


    <!-- Action Menu Item Related To Above Action Window -->
    <record id="action_survey_response_menu" model="ir.actions.act_window">
        <field name="name">Réponses</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">survey.user_input.line</field>
        <field name="view_mode">tree,form,pivot</field>
        <field name="help" type="html">
            <p>
                Réponses
            </p>
        </field>
    </record>

    <menuitem id="survey_response_menu"
              name="Réponses"
              parent="survey.menu_surveys"
              action="action_survey_response_menu"
              sequence="100"
              groups="sale_crm_extension.group_marketing"
    />

</odoo>