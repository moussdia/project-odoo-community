<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_sales_volume">
            <t t-call="web.html_container">
                <div class="header" style="border-bottom: 1px solid black;">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src='/sale_crm_extension/static/src/img/fratmat.png' style="max-height: 45px;"/>
                        </div>
                        <div class="col-xs-8">
                            <h3 class="text-center">
                                Suivi des indicateurs spécifiques au marketing : Volume des ventes
                            </h3>
                        </div>
                    </div>
                </div>
                <br/>
                <div class="article mt0 o_report_layout_standard">
                    <t t-if="indicators=='sales_volume'">
                        <table class="table table-condensed table-bordered">
                            <thead>
                                <th style="width: 30%; background-color: #24b46e; color: #fff;">Suivi régulier</th>
                                <th style="width: 70%; background-color: #24b46e; color: #fff;">Indicateurs de suivi</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        Volume des ventes
                                    </td>
                                    <td>
                                        <b>Volume du mois en cours :</b>
                                        <span>
                                            <t t-foreach="volume_of_the_current_month_docs" t-as="rec">
                                                <span t-esc="rec[0]"/>
                                            </t>
                                        </span>
                                        <br/>
                                        <b>Volume réalisé à date en cumul :</b>
                                        <span>
                                            <t t-foreach="total_volume_achieved_to_date_docs" t-as="rec">
                                                <span t-esc="rec[0]"/>
                                            </t>
                                        </span>
                                        <br/>
                                        <b>Progression du volume par rapport à l'année n-1 :</b>
                                        <br/>
                                        <t t-set="date_for_one_year_ago" t-value="datetime.datetime.now() - datetime.timedelta(days=1*365)" />
                                        <b>Volume des ventes <t t-esc="date_for_one_year_ago.strftime('%Y')"/> :</b>
                                        <br/>
                                        <span>
                                            <t t-foreach="sales_volume_for_one_year_ago" t-as="turnover">
                                                <span t-esc="turnover[0]"/>
                                            </t>
                                        </span>
                                        <br/>
                                        <b>
                                            Volume des ventes <span t-esc="datetime.datetime.now().strftime('%Y')"></span> :
                                        </b>
                                        <span>
                                            <t t-foreach="sales_volume_current_year_docs" t-as="rec">
                                                <span t-esc="rec[0]"/>
                                            </t>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </t>

                    <t t-if="indicators=='volume_achieved_compared_to_target'">
                        Indicateurs de suivi : Volume réalisé par rapport à l'objectif
                        <br/>
                        <br/>
                        <t t-foreach="seller_users" t-as="user">
                            <table class="table table-condensed table-bordered">
                                <thead>
                                    <tr>
                                        <th colspan="5">
                                            Nom du commercial:  <t t-esc="user.name"/> - Exercice commercial <t t-esc="current_sale_year[0].current_year"/>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th style="width: 20%">Période</th>
                                        <th style="width: 30%">Date de début</th>
                                        <th style="width: 30%">Date de fin</th>
                                        <th style="width: 30%">Objectif en volume</th>
                                        <th style="width: 30%">Volume réalié</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="current_sale_year[0].period_ids" t-as="periodicity">
                                        <tr>
                                            <td>
                                                <span t-esc="periodicity.name"/>
                                            </td>
                                            <td>
                                                <span t-esc="periodicity.start_date"/>
                                            </td>
                                            <td>
                                                <span t-esc="periodicity.end_date"/>
                                            </td>
                                            <td>
                                                <t t-foreach="records" t-as="rec">
                                                    <t t-if="rec.goal_id.user_id.id==user.id">
                                                        <t t-if="rec.period_id.id==periodicity.id">
                                                            <t t-esc="rec.target_goal_volume"/>
                                                        </t>
                                                        <t t-else="">
                                                        </t>
                                                    </t>
                                                </t>
                                            </td>
                                            <td>
                                                <t t-foreach="records" t-as="rec">
                                                    <t t-if="rec.goal_id.user_id.id==user.id">
                                                        <t t-if="rec.period_id.id==periodicity.id">
                                                            <t t-esc="rec.current_goal_volume"/>
                                                        </t>
                                                        <t t-else="">
                                                        </t>
                                                    </t>
                                                </t>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                    </t>
                    <t t-if="indicators=='volume_achieved_by_product_family'">
                        Indicateurs de suivi : Volume réalisé par famille de produits
                        <br/>
                        <br/>
                        <table class="table table-condensed table-bordered">
                            <thead>
                                <th style="width: 20%">Famille de produits</th>
                                <th style="width: 30%">Volume de vente</th>
                            </thead>
                            <tbody>
                                <t t-foreach="records" t-as="rec">
                                    <tr>
                                        <td>
                                            <span t-esc="rec[0]"/>
                                        </td>
                                        <td>
                                            <span t-esc="rec[1]"/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </t>
                    <t t-if="indicators=='volume_achieved_by_customer_segment'">
                        Indicateurs de suivi : Volume de vente réalisé par segment de client
                        <br/>
                        <br/>
                        <table class="table table-condensed table-bordered">
                            <thead>
                                <th style="width: 20%">Segment de client</th>
                                <th style="width: 30%">Volume de vente réalisé</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        Gros Clients
                                    </td>
                                    <td>
                                        <t t-foreach="records" t-as="rec">
                                            <t t-if="rec[0]=='gros'">
                                                <t t-esc="rec[1]"/>
                                            </t>
                                            <t t-else="">
                                            </t>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Clients Moyens
                                    </td>
                                    <td>
                                        <t t-foreach="records" t-as="rec">
                                            <t t-if="rec[0]=='moyen'">
                                                <t t-esc="rec[1]"/>
                                            </t>
                                            <t t-else="">
                                            </t>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Petits Clients
                                    </td>
                                    <td>
                                        <t t-foreach="records" t-as="rec">
                                            <t t-if="rec[0]=='petit'">
                                                <t t-esc="rec[1]"/>
                                            </t>
                                            <t t-else="">
                                            </t>
                                        </t>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </t>
                    <t t-if="indicators=='volume_achieved_by_region_or_zone'">
                        Indicateurs de suivi : Volume de vente réalisé par région / zone géographique
                        <br/>
                        <br/>
                        <table class="table table-condensed table-bordered">
                            <thead>
                                <th style="width: 20%">Zone Géographique</th>
                                <th style="width: 30%">Volume de vente réalisé</th>
                            </thead>
                            <tbody>
                                <t t-foreach="geographical_area" t-as="zone">
                                    <tr>
                                        <td>
                                            <span t-esc="zone.zone"/>
                                        </td>
                                        <td>
                                            <t t-foreach="records" t-as="rec">
                                                <t t-if="rec[0]==zone.id">
                                                    <t t-esc="rec[1]"/>
                                                </t>
                                                <t t-else="">
                                                </t>
                                            </t>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </t>
                </div>
                <div class="footer o_standard_footer" style="border-top: 1px solid black; font-size:10px !important;">
                    <div class="text-center" style="border-top: 1px solid black;">
                        <ul class="list-inline">
                            <li style="display: inline;">FRATERNITE MATIN (FRATMAT)</li>
                        </ul>
                        <ul class="list-inline" style="margin-top:-10px">
                            <li style="display: inline;">Bd. Général de Gaulle - 80 logements Adjamé - 01 BP 1807 Abidjan 01 Abidjan - Côte d’Ivoire </li>
                        </ul>
                        <ul class="list-inline" style="margin-top:-10px">
                            <li style="display: inline;">(+225) 20 30 60 00 </li>
                            <li style="display: inline"> - </li>
                            <li style="display: inline;">www.fratmat.info</li>
                        </ul>
                        <ul class="list-inline" style="margin-top:-10px">
                            <li style="display: inline;">Page:</li>
                            <li style="display: inline;"><span class="page"/></li>
                            <li style="display: inline;">/</li>
                            <li style="display: inline;"><span class="topage"/></li>
                        </ul>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>



